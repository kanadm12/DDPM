# base_cfg_ddpm.yaml - DDPM Training Configuration with VQ-GAN
# Location: /workspace/ddpm/config/base_cfg_ddpm.yaml

dataset:
  ctpa_dir: "/workspace/data/final_patient_data"
  pa_drr_pattern: "*_pa_drr.png"
  lateral_drr_pattern: "*_lat_drr.png"
  patch_size: [128, 128, 128]
  stride: [128, 128, 128]
  train_split: 0.9  # Increased to 90% train, 10% val (since many files corrupted)
  max_patients: null
  normalization: "min_max"
  drr_rotation_angle: 180
  num_workers: 20

model:
  # VQ-GAN Checkpoints
  vqgan_ckpt: "/workspace/checkpoint/vqgan_encoder_decoder.ckpt"
  vae_ckpt: null
  
  # Model architecture
  diffusion_img_size: 16
  diffusion_num_channels: 4
  diffusion_depth_size: 8
  cond_dim: 2
  
  # UNet3D configuration
  dim: 64
  dim_mults: [1, 2, 4, 8]
  classifier_free_guidance: true
  medclip: false
  
  # Training hyperparameters
  batch_size: 1
  learning_rate: 1.0e-4
  weight_decay: 0.0
  seed: 42
  max_epochs: 10
  
  # Optimization
  amp: true
  gradient_checkpointing: true
  gradient_accumulate_every: 4
  max_grad_norm: 1.0
  sync_batchnorm: true
  
  # Loss weights
  loss_type: "l1"
  l1_weight: 1.0
  perceptual_weight: 0.1
  discriminator_weight: 0.1
  classification_weight: 0.0
  
  # Data normalization
  dataset_min_value: 0.0
  dataset_max_value: 1.0
  
  # Dataset name
  name_dataset: "xray_ctpa_dual_drr"
  
  # Results and checkpoints
  results_folder: "/workspace/results/ddpm_dual_drr"
  resume_ckpt: null
  
  # Checkpoint interval
  checkpoint_interval: 5
  log_interval: 50
  timesteps: 1000
  skip_validation: true  # Skip validation completely